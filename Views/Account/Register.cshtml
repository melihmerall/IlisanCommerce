@model IlisanCommerce.Models.RegisterViewModel

@{
    ViewData["Title"] = "Üye Ol";
    ViewData["MetaDescription"] = "ILISAN'a üye olun. Hızlı alışveriş, özel indirimler ve birçok avantajdan yararlanın.";
}

<section class="main-banner mv-wrap">
    <div data-image-src="images/background/demo_bg_1920x1680.png" class="mv-banner-style-1 mv-bg-overlay-dark overlay-0-85 mv-parallax">
        <div class="page-name mv-caption-style-6">
            <div class="container">
                <div class="mv-title-style-9"><span class="main">Üye Ol</span><img src="images/icon/icon_line_polygon_line.png" alt="icon" class="line" /></div>
            </div>
        </div>
    </div>
</section>
<!-- .main-banner-->

<section class="main-breadcrumb mv-wrap">
    <div class="mv-breadcrumb-style-1">
        <div class="container">
            <ul class="breadcrumb-1-list">
                <li><a asp-controller="Home" asp-action="Index"><i class="fa fa-home"></i></a></li>
                <li><a>Üye Ol</a></li>
            </ul>
        </div>
    </div>
</section>
<!-- .main-breadcrumb-->

<section class="mv-main-body login-main mv-bg-gray mv-wrap">
    <div class="container">
        <div class="row">
            <div class="col-sm-6 col-register">
                <div class="mv-form-style-1 mv-box-shadow-gray-1">
                    <form asp-controller="Account" asp-action="Register" method="post" class="form-register">
                        @Html.AntiForgeryToken()
                        
                        <div class="form-header">
                            <div class="mv-title-style-13">
                                <div class="text-main">Yeni Hesap Oluştur</div>
                                <div class="text-sub">ILISAN ailesine katılın ve ayrıcalıklardan yararlanın</div>
                            </div>
                        </div>
                        <!-- .form-header-->

                        <div class="form-body">
                            <div class="mv-form-group">
                                <div class="mv-label"> <strong class="text-uppercase">Ad</strong></div>
                                <div class="mv-field">
                                    <input asp-for="FirstName" type="text" class="mv-inputbox mv-inputbox-style-1" placeholder="Adınızı giriniz" />
                                    <span asp-validation-for="FirstName" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mv-form-group">
                                <div class="mv-label"> <strong class="text-uppercase">Soyad</strong></div>
                                <div class="mv-field">
                                    <input asp-for="LastName" type="text" class="mv-inputbox mv-inputbox-style-1" placeholder="Soyadınızı giriniz" />
                                    <span asp-validation-for="LastName" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mv-form-group">
                                <div class="mv-label"> <strong class="text-uppercase">E-posta</strong></div>
                                <div class="mv-field">
                                    <input asp-for="Email" type="email" class="mv-inputbox mv-inputbox-style-1" placeholder="ornek@email.com" />
                                    <span asp-validation-for="Email" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mv-form-group">
                                <div class="mv-label"> <strong class="text-uppercase">Telefon</strong></div>
                                <div class="mv-field">
                                    <input asp-for="Phone" type="tel" class="mv-inputbox mv-inputbox-style-1" placeholder="0555 123 45 67" />
                                    <span asp-validation-for="Phone" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mv-form-group">
                                <div class="mv-label"> <strong class="text-uppercase">Şifre</strong></div>
                                <div class="mv-field">
                                    <input asp-for="Password" type="password" class="mv-inputbox mv-inputbox-style-1" placeholder="En az 6 karakter" />
                                    <span asp-validation-for="Password" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mv-form-group">
                                <div class="mv-label"> <strong class="text-uppercase">Şifre Onayı</strong></div>
                                <div class="mv-field">
                                    <input asp-for="ConfirmPassword" type="password" class="mv-inputbox mv-inputbox-style-1" placeholder="Şifrenizi tekrar giriniz" />
                                    <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mv-form-group">
                                <label class="mv-checkbox mv-checkbox-style-1 checkbox-agreement">
                                    <input asp-for="AcceptTerms" type="checkbox" class="hidden" />
                                    <span class="checkbox-after-input">
                                        <span class="checkbox-visual-box">
                                            <span class="icon-checked fa fa-check"></span>
                                        </span>
                                        <span class="checkbox-text">
                                            <a href="#" class="text-primary">Üyelik Sözleşmesi</a>'ni ve 
                                            <a href="#" class="text-primary">Gizlilik Politikası</a>'nı okudum, kabul ediyorum.
                                        </span>
                                    </span>
                                </label>
                                <span asp-validation-for="AcceptTerms" class="text-danger"></span>
                            </div>

                            <div class="mv-form-group submit-button mv-mt-30">
                                <button type="submit" class="mv-btn mv-btn-style-5 btn-signup">Hesap Oluştur</button>
                            </div>
                        </div>
                        <!-- .form-body-->
                    </form>
                    <!-- .form-register-->
                </div>
            </div>

            <div class="col-sm-6 col-login">
                <div class="mv-form-style-1 mv-box-shadow-gray-1">
                    <div class="form-header">
                        <div class="mv-title-style-13">
                            <div class="text-main">Zaten Hesabınız Var mı?</div>
                            <div class="text-sub">ILISAN hesabınıza giriş yaparak alışverişe devam edin</div>
                        </div>
                    </div>
                    <!-- .form-header-->

                    <div class="form-body">
                        <div class="mv-form-group">
                            <p class="text-center" style="margin: 20px 0;">
                                <strong>Kayıtlı bir hesabınız var mı?</strong><br>
                                Giriş yaparak hesabınıza erişebilirsiniz.
                            </p>
                        </div>

                        <div class="mv-form-group submit-button mv-mt-30">
                            <a asp-controller="Account" asp-action="Login" class="mv-btn mv-btn-style-5 btn-login" style="width: 100%; text-align: center; display: block;">
                                Giriş Yap
                            </a>
                        </div>

                        <div class="mv-form-group">
                            <div class="text-center" style="margin-top: 20px;">
                                <p style="color: #666; font-size: 14px;">
                                    Giriş yaparak aşağıdaki avantajlardan yararlanabilirsiniz:
                                </p>
                                <ul style="text-align: left; color: #666; font-size: 13px; margin-top: 10px;">
                                    <li>✓ Kaydedilmiş adres bilgileri</li>
                                    <li>✓ Sipariş geçmişi ve takip</li>
                                    <li>✓ Hızlı ödeme seçenekleri</li>
                                    <li>✓ Favori ürünlerinize erişim</li>
                                    <li>✓ Özel kampanya ve indirimleri</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- .form-body-->
                </div>
            </div>
        </div>
    </div>
</section>
<!-- .mv-main-body-->

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
    
<style>
    .mv-inputbox.error {
        border-color: #dc3545 !important;
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
    }
    
    .text-danger {
        color: #dc3545;
        font-size: 12px;
        margin-top: 5px;
        display: block;
    }
    
    .alert {
        padding: 12px 16px;
        margin-bottom: 20px;
        border: 1px solid transparent;
        border-radius: 4px;
        animation: slideIn 0.3s ease-out;
    }
    
    .alert-success {
        color: #155724;
        background-color: #d4edda;
        border-color: #c3e6cb;
    }
    
    .alert-danger {
        color: #721c24;
        background-color: #f8d7da;
        border-color: #f5c6cb;
    }

    @@keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Toast bildirimleri için */
    .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
    }

    .toast {
        min-width: 300px;
        margin-bottom: 10px;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        animation: slideInRight 0.3s ease-out;
    }

    .toast-success {
        background-color: #28a745;
    }

    .toast-error {
        background-color: #dc3545;
    }

    @@keyframes slideInRight {
        from {
            opacity: 0;
            transform: translateX(100%);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .checkbox-text a {
        color: #007bff;
        text-decoration: none;
    }

    .checkbox-text a:hover {
        text-decoration: underline;
    }
</style>

<script>
    // Toast bildirimleri için JavaScript
    function showToast(message, type = 'success') {
        const toastContainer = document.getElementById('toast-container') || createToastContainer();
        
        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        toast.textContent = message;
        
        toastContainer.appendChild(toast);
        
        // 5 saniye sonra toast'ı kaldır
        setTimeout(() => {
            toast.style.animation = 'slideInRight 0.3s ease-out reverse';
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 300);
        }, 5000);
    }

    function createToastContainer() {
        const container = document.createElement('div');
        container.id = 'toast-container';
        container.className = 'toast-container';
        document.body.appendChild(container);
        return container;
    }

    // Sayfa yüklendiğinde TempData mesajlarını kontrol et
    document.addEventListener('DOMContentLoaded', function() {
        @if (!string.IsNullOrEmpty(TempData["SuccessMessage"] as string))
        {
            <text>
            showToast('@Html.Raw(TempData["SuccessMessage"])', 'success');
            </text>
        }
        
        @if (!string.IsNullOrEmpty(TempData["ErrorMessage"] as string))
        {
            <text>
            showToast('@Html.Raw(TempData["ErrorMessage"])', 'error');
            </text>
        }

        // Telefon numarası formatlaması
        const phoneInput = document.querySelector('input[name="Phone"]');
        if (phoneInput) {
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 0) {
                    if (value.length <= 3) {
                        value = value;
                    } else if (value.length <= 6) {
                        value = value.slice(0, 3) + ' ' + value.slice(3);
                    } else if (value.length <= 8) {
                        value = value.slice(0, 3) + ' ' + value.slice(3, 6) + ' ' + value.slice(6);
                    } else if (value.length <= 10) {
                        value = value.slice(0, 3) + ' ' + value.slice(3, 6) + ' ' + value.slice(6, 8) + ' ' + value.slice(8);
                    } else {
                        value = value.slice(0, 3) + ' ' + value.slice(3, 6) + ' ' + value.slice(6, 8) + ' ' + value.slice(8, 10);
                    }
                }
                e.target.value = value;
            });
        }

        // Form validation enhancement
        const form = document.querySelector('.form-register');
        const agreementCheckbox = document.querySelector('input[name="AcceptTerms"]');
        
        form.addEventListener('submit', function(e) {
            if (!agreementCheckbox.checked) {
                e.preventDefault();
                showToast('Lütfen üyelik sözleşmesini ve gizlilik politikasını kabul ediniz.', 'error');
                agreementCheckbox.focus();
                return false;
            }
        });

        // Real-time validation feedback
        const inputs = form.querySelectorAll('.mv-inputbox');
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() !== '') {
                    if (this.checkValidity()) {
                        this.style.borderColor = '#28a745';
                        this.classList.remove('error');
                    } else {
                        this.style.borderColor = '#dc3545';
                        this.classList.add('error');
                    }
                } else {
                    this.style.borderColor = '';
                    this.classList.remove('error');
                }
            });

            input.addEventListener('input', function() {
                if (this.classList.contains('error') && this.checkValidity()) {
                    this.style.borderColor = '#28a745';
                    this.classList.remove('error');
                }
            });
        });

        // Password confirmation validation
        const passwordInput = document.querySelector('input[name="Password"]');
        const confirmPasswordInput = document.querySelector('input[name="ConfirmPassword"]');

        if (confirmPasswordInput) {
            confirmPasswordInput.addEventListener('input', function() {
                if (passwordInput.value !== '' && confirmPasswordInput.value !== '') {
                    if (passwordInput.value === confirmPasswordInput.value) {
                        confirmPasswordInput.style.borderColor = '#28a745';
                        confirmPasswordInput.classList.remove('error');
                    } else {
                        confirmPasswordInput.style.borderColor = '#dc3545';
                        confirmPasswordInput.classList.add('error');
                    }
                }
            });
        }
    });
</script>