@model TestEmailViewModel
@{
    ViewData["Title"] = "Test Email GÃ¶nder";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-envelope"></i> Test Email GÃ¶nder
                    </h3>
                </div>
                <div class="card-body">
                    @if (TempData["SuccessMessage"] != null)
                    {
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <i class="fas fa-check-circle"></i> @TempData["SuccessMessage"]
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    }

                    @if (TempData["ErrorMessage"] != null)
                    {
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            <i class="fas fa-exclamation-circle"></i> @TempData["ErrorMessage"]
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    }

                    <form asp-action="TestEmail" method="post">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label asp-for="RecipientEmail" class="form-label">
                                        <i class="fas fa-envelope"></i> AlÄ±cÄ± Email *
                                    </label>
                                    <input asp-for="RecipientEmail" class="form-control" placeholder="ornek@email.com" />
                                    <span asp-validation-for="RecipientEmail" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label asp-for="RecipientName" class="form-label">
                                        <i class="fas fa-user"></i> AlÄ±cÄ± AdÄ±
                                    </label>
                                    <input asp-for="RecipientName" class="form-control" placeholder="Test KullanÄ±cÄ±" />
                                    <span asp-validation-for="RecipientName" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label asp-for="EmailType" class="form-label">
                                <i class="fas fa-list"></i> Email Tipi *
                            </label>
                            <select asp-for="EmailType" class="form-control" id="emailTypeSelect">
                                <option value="">Email tipi seÃ§iniz...</option>
                                <option value="welcome">ğŸ‰ HoÅŸ Geldin Email</option>
                                <option value="order_confirmation">ğŸ“¦ SipariÅŸ Onay Email</option>
                                <option value="password_reset">ğŸ” Åifre SÄ±fÄ±rlama Email</option>
                                <option value="shipping_notification">ğŸšš Kargo Bildirimi Email</option>
                                <option value="delivery_confirmation">âœ… Teslimat OnayÄ± Email</option>
                                <option value="order_cancellation">âŒ SipariÅŸ Ä°ptali Email</option>
                                <option value="contact_form">ğŸ“§ Ä°letiÅŸim Formu Email</option>
                                <option value="custom">âœï¸ Ã–zel Email</option>
                            </select>
                            <span asp-validation-for="EmailType" class="text-danger"></span>
                        </div>

                        <!-- Custom Email Fields (hidden by default) -->
                        <div id="customEmailFields" style="display: none;">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label asp-for="Subject" class="form-label">
                                            <i class="fas fa-tag"></i> Konu
                                        </label>
                                        <input asp-for="Subject" class="form-control" placeholder="Email konusu" />
                                        <span asp-validation-for="Subject" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label asp-for="Message" class="form-label">
                                    <i class="fas fa-comment"></i> Mesaj
                                </label>
                                <textarea asp-for="Message" class="form-control" rows="5" placeholder="Email iÃ§eriÄŸi"></textarea>
                                <span asp-validation-for="Message" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Email Template Info -->
                        <div id="templateInfo" class="alert alert-info" style="display: none;">
                            <h6><i class="fas fa-info-circle"></i> SeÃ§ilen Email Template Bilgisi:</h6>
                            <div id="templateDescription"></div>
                        </div>

                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Test Email GÃ¶nder
                            </button>
                            <a href="@Url.Action("Dashboard")" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Geri DÃ¶n
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Email Templates Info Card -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-info-circle"></i> Email Template'leri HakkÄ±nda
                    </h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-envelope text-primary"></i> MÃ¼ÅŸteri Email'leri</h6>
                            <ul class="list-unstyled">
                                <li><strong>HoÅŸ Geldin:</strong> Yeni Ã¼ye kaydÄ±nda gÃ¶nderilir</li>
                                <li><strong>SipariÅŸ Onay:</strong> SipariÅŸ alÄ±ndÄ±ÄŸÄ±nda gÃ¶nderilir</li>
                                <li><strong>Åifre SÄ±fÄ±rlama:</strong> Åifre sÄ±fÄ±rlama talebinde gÃ¶nderilir</li>
                                <li><strong>Kargo Bildirimi:</strong> SipariÅŸ kargoya verildiÄŸinde gÃ¶nderilir</li>
                                <li><strong>Teslimat OnayÄ±:</strong> SipariÅŸ teslim edildiÄŸinde gÃ¶nderilir</li>
                                <li><strong>SipariÅŸ Ä°ptali:</strong> SipariÅŸ iptal edildiÄŸinde gÃ¶nderilir</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-cog text-success"></i> Sistem Email'leri</h6>
                            <ul class="list-unstyled">
                                <li><strong>Ä°letiÅŸim Formu:</strong> Admin'e iletiÅŸim formu bildirimi</li>
                                <li><strong>Ã–zel Email:</strong> Kendi konu ve mesajÄ±nÄ±zla test</li>
                            </ul>
                            
                            <div class="alert alert-warning mt-3">
                                <small>
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <strong>Not:</strong> Test email'leri gerÃ§ek verilerle gÃ¶nderilir. 
                                    SMTP ayarlarÄ±nÄ±zÄ±n doÄŸru olduÄŸundan emin olun.
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Email type change handler
            $('#emailTypeSelect').change(function() {
                var selectedType = $(this).val();
                var customFields = $('#customEmailFields');
                var templateInfo = $('#templateInfo');
                var templateDescription = $('#templateDescription');
                
                // Hide custom fields by default
                customFields.hide();
                templateInfo.hide();
                
                // Show custom fields for custom email type
                if (selectedType === 'custom') {
                    customFields.show();
                    templateInfo.hide();
                } else if (selectedType) {
                    // Show template info for other types
                    customFields.hide();
                    templateInfo.show();
                    
                    // Set template description
                    var descriptions = {
                        'welcome': 'MÃ¼ÅŸteri kayÄ±t olduÄŸunda gÃ¶nderilen hoÅŸ geldin email template\'i. KiÅŸiselleÅŸtirilmiÅŸ iÃ§erik ve Ã¼yelik avantajlarÄ± iÃ§erir.',
                        'order_confirmation': 'SipariÅŸ alÄ±ndÄ±ÄŸÄ±nda mÃ¼ÅŸteriye gÃ¶nderilen onay email\'i. SipariÅŸ detaylarÄ± ve Ã¶deme bilgileri iÃ§erir.',
                        'password_reset': 'Åifre sÄ±fÄ±rlama talebinde gÃ¶nderilen gÃ¼venlik email\'i. 24 saat geÃ§erli link iÃ§erir.',
                        'shipping_notification': 'SipariÅŸ kargoya verildiÄŸinde gÃ¶nderilen bildirim. Takip numarasÄ± ve kargo bilgileri iÃ§erir.',
                        'delivery_confirmation': 'SipariÅŸ teslim edildiÄŸinde gÃ¶nderilen onay email\'i. Teslimat detaylarÄ± ve deÄŸerlendirme linki iÃ§erir.',
                        'order_cancellation': 'SipariÅŸ iptal edildiÄŸinde gÃ¶nderilen bildirim. Ä°ptal sebebi ve iade bilgileri iÃ§erir.',
                        'contact_form': 'Ä°letiÅŸim formu gÃ¶nderildiÄŸinde admin\'e gÃ¶nderilen bildirim. GÃ¶nderen bilgileri ve mesaj iÃ§eriÄŸi iÃ§erir.'
                    };
                    
                    templateDescription.html(descriptions[selectedType] || '');
                }
            });
            
            // Trigger change event on page load
            $('#emailTypeSelect').trigger('change');
        });
    </script>
}
