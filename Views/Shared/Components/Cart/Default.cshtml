@model IlisanCommerce.ViewComponents.CartMiniViewModel

<div class="item-button dropdown mv-dropdown-style-1 script-dropdown-1">
    <button type="button" class="mv-btn mv-btn-style-11 btn-dropdown btn-my-cart">
        <span class="btn-inner">
            <span class="icon fa fa-shopping-bag"></span>
            <span class="number" id="cart-count">@Model.ItemCount</span>
        </span>
    </button>
    <div class="dropdown-menu pull-right">
        <div class="dropdown-menu-inner">
            <div class="mv-block-style-39">
                <div class="block-39-header">
                    Sepetinizde <span class="mv-color-primary" id="cart-items-count">@Model.ItemCount ürün</span> var
                </div>

                <div class="block-39-list" id="cart-preview-list">
                    @if (Model.Items.Any())
                    {
                        foreach (var item in Model.Items)
                        {
                            <article class="item post" data-cart-item-id="@item.Id">
                                <div class="item-inner">
                                    <div class="mv-dp-table align-top">
                                        <div class="mv-dp-table-cell block-39-thumb">
                                            <div class="thumb-inner mv-lightbox-style-1">
                                                <a asp-controller="Product" asp-action="Details" asp-route-slug="@item.Product.Slug">
                                                    <img src="@((item.Product.ProductImages?.FirstOrDefault(pi => pi.IsMainImage)?.ImagePath ?? "/images/demo/demo_80x100.png"))" class="block-39-thumb-img" />
                                                </a>
                                            </div>
                                        </div>
                                        <div class="mv-dp-table-cell block-39-main">
                                            <div class="block-39-main-inner">
                                                <div class="block-39-title">
                                                    <a asp-controller="Product" asp-action="Details" asp-route-slug="@item.Product.Slug" class="mv-overflow-ellipsis">@item.Product.Name</a>
                                                </div>
                                                <div class="block-39-price">
                                                    <div class="new-price">@item.Product.Price.ToString("C", new System.Globalization.CultureInfo("tr-TR"))</div>
                                                </div>
                                                <ul class="block-24-meta mv-ul">
                                                    <li class="meta-item mv-icon-left-style-3"><span class="text">Adet: @item.Quantity</span></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" class="mv-btn mv-btn-style-4 fa fa-close btn-delete-product" data-cart-item-id="@item.Id"></button>
                                </div>
                            </article>
                        }
                    }
                    else
                    {
                        <div class="text-center" style="padding: 20px;">
                            <p>Sepetinizde ürün bulunmuyor.</p>
                        </div>
                    }
                </div>

                <div class="block-39-total mv-col-wrapper">
                    <div class="mv-col-left">Toplam</div>
                    <div class="mv-col-right" id="cart-total">@Model.TotalAmount.ToString("C", new System.Globalization.CultureInfo("tr-TR"))</div>
                </div>

                <div class="block-39-footer">
                    <div class="row">
                        <div class="col-xs-6">
                            <a asp-controller="Cart" asp-action="Index" class="mv-btn mv-btn-style-5 btn-5-h-45 btn-5-gray responsive-btn-5-type-2 mv-btn-block">Sepeti Görüntüle</a>
                        </div>
                        <div class="col-xs-6">
                            <a asp-controller="Order" asp-action="Checkout" class="mv-btn mv-btn-style-5 btn-5-h-45 responsive-btn-5-type-2 mv-btn-block">Ödeme</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- .mv-block-style-39-->
        </div>
    </div>
</div>
